```python
import glob
img_name_list = glob.glob('../data/vesselseg/DRIVE/training/images/*_training.tif')
img_name_list.sort()
img_name_list
```




    ['../data/vesselseg/DRIVE/training/images/21_training.tif',
     '../data/vesselseg/DRIVE/training/images/22_training.tif',
     '../data/vesselseg/DRIVE/training/images/23_training.tif',
     '../data/vesselseg/DRIVE/training/images/24_training.tif',
     '../data/vesselseg/DRIVE/training/images/25_training.tif',
     '../data/vesselseg/DRIVE/training/images/26_training.tif',
     '../data/vesselseg/DRIVE/training/images/27_training.tif',
     '../data/vesselseg/DRIVE/training/images/28_training.tif',
     '../data/vesselseg/DRIVE/training/images/29_training.tif',
     '../data/vesselseg/DRIVE/training/images/30_training.tif',
     '../data/vesselseg/DRIVE/training/images/31_training.tif',
     '../data/vesselseg/DRIVE/training/images/32_training.tif',
     '../data/vesselseg/DRIVE/training/images/33_training.tif',
     '../data/vesselseg/DRIVE/training/images/34_training.tif',
     '../data/vesselseg/DRIVE/training/images/35_training.tif',
     '../data/vesselseg/DRIVE/training/images/36_training.tif',
     '../data/vesselseg/DRIVE/training/images/37_training.tif',
     '../data/vesselseg/DRIVE/training/images/38_training.tif',
     '../data/vesselseg/DRIVE/training/images/39_training.tif',
     '../data/vesselseg/DRIVE/training/images/40_training.tif']




```python
from PIL import Image
import numpy as np
```


```python
#convert RGB image in black and white
def rgb2gray(rgb):
    assert (len(rgb.shape)==4)  #4D arrays
    assert (rgb.shape[1]==3)
    # G 通道与背景的对比度强，权值大
    bn_imgs = rgb[:,0,:,:]*0.299 + rgb[:,1,:,:]*0.587 + rgb[:,2,:,:]*0.114
    bn_imgs = np.reshape(bn_imgs,(rgb.shape[0],1,rgb.shape[2],rgb.shape[3]))
    return bn_imgs
```


```python
imgs = None
for img_name in img_name_list:
    # 通道顺序为：B G R.
    img = Image.open(img_name)
    print(img.size)
    
    # Convert the dimension of imgs to [N,C,H,W]
    imgs = np.expand_dims(img,0)
    imgs = np.transpose(imgs,(0,3,1,2))
    print(imgs.shape)
    
    # black-white conversion
    train_imgs = rgb2gray(imgs)
    print(train_imgs.shape)
    
#     # 数据预处理
#     train_imgs = dataset_normalized(train_imgs)
#     train_imgs = clahe_equalized(train_imgs)
#     train_imgs = adjust_gamma(train_imgs, 1.2)
#     train_imgs = train_imgs/255.  #reduce to 0-1 range
```

    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)
    (565, 584)
    (1, 3, 584, 565)
    (1, 1, 584, 565)


## STARE


```python
STARE_path = glob.glob('./../data/vesselseg/STARE/images/*.ppm')
STARE_path.sort()
STARE_path
```




    ['./../data/vesselseg/STARE/images/im0001.ppm',
     './../data/vesselseg/STARE/images/im0002.ppm',
     './../data/vesselseg/STARE/images/im0003.ppm',
     './../data/vesselseg/STARE/images/im0004.ppm',
     './../data/vesselseg/STARE/images/im0005.ppm',
     './../data/vesselseg/STARE/images/im0044.ppm',
     './../data/vesselseg/STARE/images/im0077.ppm',
     './../data/vesselseg/STARE/images/im0081.ppm',
     './../data/vesselseg/STARE/images/im0082.ppm',
     './../data/vesselseg/STARE/images/im0139.ppm',
     './../data/vesselseg/STARE/images/im0162.ppm',
     './../data/vesselseg/STARE/images/im0163.ppm',
     './../data/vesselseg/STARE/images/im0235.ppm',
     './../data/vesselseg/STARE/images/im0236.ppm',
     './../data/vesselseg/STARE/images/im0239.ppm',
     './../data/vesselseg/STARE/images/im0240.ppm',
     './../data/vesselseg/STARE/images/im0255.ppm',
     './../data/vesselseg/STARE/images/im0291.ppm',
     './../data/vesselseg/STARE/images/im0319.ppm',
     './../data/vesselseg/STARE/images/im0324.ppm']




```python
for img_name in STARE_path:
    img = Image.open(img_name)
    print(img.size)
    
    # Convert the dimension of imgs to [N,C,H,W]
    imgs = np.expand_dims(img,0)
    imgs = np.transpose(imgs,(0,3,1,2))
    print(imgs.shape)
    
```

    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)



```python
SHASE_DB1_path = glob.glob('./../data/vesselseg/CHASEDB1/images/*.jpg')
SHASE_DB1_path.sort()
SHASE_DB1_path
```




    ['./../data/vesselseg/CHASEDB1/images/Image_01L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_01R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_02L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_02R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_03L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_03R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_04L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_04R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_05L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_05R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_06L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_06R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_07L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_07R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_08L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_08R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_09L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_09R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_10L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_10R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_11L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_11R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_12L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_12R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_13L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_13R.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_14L.jpg',
     './../data/vesselseg/CHASEDB1/images/Image_14R.jpg']




```python
for img_name in STARE_path:
    img = Image.open(img_name)
    print(img.size)
    
    # Convert the dimension of imgs to [N,C,H,W]
    imgs = np.expand_dims(img,0)
    imgs = np.transpose(imgs,(0,3,1,2))
    print(imgs.shape)
```

    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)
    (700, 605)
    (1, 3, 605, 700)



```python

```
