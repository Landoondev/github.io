# 国科大计算机网络复习（2020 秋季学期）

## 1. 计算机网络体系结构

OSI (Open Systems Interconnection) 参考模型和 TCP/IP 模型

![](./network/1.jpeg)

TCP/IP 四层模型的代表协议：

- 网络接口层（Link Layer）：ARP 协议（IP addr ---ARP--->MAC addr）
- IP 网络层（Internet Layer）：IP、ICMP、IGMP 等协议。
- 传输层（Transport Layer）：TCP 和 UDP 协议
- 应用层（Application Layer）：HTTP、SMTP、DNS、FTP、SSH、DHCP、Telnet



数据传输单位：

- 物理层：比特
- 数据链路层：帧
- 网络层：数据报
- 传输层：报文段（TCP）、报文段（UDP）

**TCP/IP 四层结构有什么优缺点？**

优点：

- TCP/IP 在设计之初就考虑到了多种异构网的互联问题，并将 IP 作为一个单独的重要层次。

缺点：

- 它在服务、接口与协议的区别上不清楚。
- TCP/IP 的主机－网络层本身并不是实际的一层，它定义了网络层与数据链路层的接口。物理层与数据链路层的划分是必要和合理的，一个好的参考模型应该将它们区分开来，而 TCP/IP 参考模型却没有做到这点。

OSI 七层模型的优缺点？

优点：

- OSI 参考模型的最大贡献就是精确定义了三个主要概念：服务、接口和协议。这与现代的面向对象程序设计思想非常吻合。
- OSI 参考模型产生在协议发明之前，通用性较好。

## 2. TCP

### 2.1 慢启动

慢启动机制

- 初始窗口 initial cwnd，初始值设置为 3 或 10
- 慢启动门限值 ssthresh，初始值设置为 1 << 31
- 每收到 ACK，窗口值加 1

慢启动并不慢
- 在没有丢包情况下，经过log2(target_cwnd/initial_cwnd)个RTT长到目标窗口大小

### 2.2 快速重传

- 一般情况下，先发送的数据包应该先到达。如果后发送的数据包先被确认，可推测先发送的数据包丢失。
- 如果一个数据包后面的**三个**数据包都被确认，而该数据包还未收到确认，则认定该数据包丢失，并重传该数据包。
- 数据包通常都是连续发送的。快速重传通常可以在1个RTT内重传数据丢包。

**为什么需要等 3 个后续数据包的确认?**

- 防止因数据包乱序引起的误重传
- 在无线网络、多路径传输中会有部分乱序
- 假设网络中乱序长度不大于 3 个数据包
- 通过 D-SACK 机制 (Duplicate SACK) 识别一个数据包没有丢失，而是乱序。

**一般来说，快速重传可以恢复长流中的大部分丢包。**

### 3.2 超时重传

- 重传后丢包，即同一数据包被丢弃两次后，只能等待超时重传。

- 通过超时来判断数据包丢失
- 定时器至少大于一个 RTT (Round Trip Time)
- 定时器必须能够适应 RTT 变化，定时器必须同时反映出 RTT 大小和 RTT 变化
- Linux 中最小值为 200ms

### 3.3 避免拥塞

**流控（Flow Control）**：

- 为了防止快发送方给慢接收方发数据造成接收崩溃。注意与拥塞控制的区别。
- 发送方和接收方各自维护一个窗口大小

**两种拥塞控制思路**：

- 端到端的拥塞控制：端设备通过丢包、延迟变化 等推测网络拥塞状况。TCP 使用端到端的拥塞控制策略。
- 网络辅助的拥塞控制：网络设备对端设备提供反馈。

**TCP 的拥塞控制算法基础：**

- (1) TCP 端设备遇到丢包时，认为网络拥塞，减慢发送速率（发送速率（窗口大小）减半）
- (2) TCP 端设备定期通过增大发送速率来探测更多可用带宽（每个 RTT，窗口值增加一个数据包大小）



















